# 数据库 !!

## 一、基础
1. 引擎 
   1. 你了解的myql存储引擎有哪些？ (京东科技、字节飞书、百度)
   2. innoDB 和 MyISAM 的区别 (网易云音乐)
2. 隔离级别
   1. 有几种隔离级别 默认是哪个，什么是脏读、幻读 (拼多多、字节番茄小说、小米、京东科技、字节飞书、有赞\京东)
   2. 什么是脏读，什么是不可重复读 (小米)
3. 锁
   1. 常用的锁有哪些 (虾皮)
   2. 间隙锁是什么 (京东)
   3. 怎么实现的可重复读 (字节番茄小说、京东科技、有赞)
      - 主要从锁机制+MVCC的角度讲，详细说明了当前要访问的版本的事务id和ReadView中活跃事务id列表的关系，如果大于最大值怎么样，小于最小值怎么样，介于最大值最小值之间要怎么办
   4. 从mysql事务出发，要求画出RC和RR隔离级别下的MVCC (美团)
   5. MVCC 乐观锁/悲观锁 是怎么实现的 (拼多多、京东科技、字节抖音、虾皮)
   6. 封锁粒度，封锁类型有哪些 (京东科技)
   7. 那你了解哪些在SQL语句中可以用的悲观锁？ (京东科技)
   8. select for update是表锁还是行锁？ (京东科技、字节抖音)
   9. 保证幂等性的方案 (字节抖音)
4. 事务
   1. 讲讲 ACID (京东、小米、蚂蚁、有赞)
   2. mysql怎么支持事务的？(字节飞书)
5. 数据格式
   1. mysql 里面的数据类型 (快手)
   2. mysql 里面时间是怎么存储的 (快手)
   3. 建了一个表，索引应该怎么定义它的数据结构，比如varchar，占得小有什么好处 (京东)
   4. IO次数和什么有关系，IO一次取决于什么，磁盘页的大小 (京东)
   5. 对深度分页知道吗 (京东)

## 二、索引
1. 讲一下对索引的理解 (网易云音乐、百度)
2. 索引类型
   1. 有多少用类型的索引 (快手、顺丰)
   2. 聚簇索引 和 非聚簇索引 (字节番茄小说、快手、有赞)
   4. 有1亿数据，走主键索引，mysql底层 IO次数是多少？(字节抖音)
3. 索引的数据类型
   1. mysql索引的底层实现？(字节抖音、字节飞书)
   2. Mysql 索引优缺点，为什么用b+树不用红黑树，用红黑树时间复杂度是多少 (拼多多、字节、小米、京东*2)
      - 二叉树和B树，B+树的优缺点
   3. b+树的结构，叶子节点设计成有序链表的好处 (网易云音乐)
   4. MySQL联台索引的结构，在b+树上体现? (网易云音乐)
4. 索引下推是什么？

5. 从联合索引出发，要求画出联合索引B+树索引图  (美团)
6. 怎么创建索引 (字节飞书)
7. 创建索引时要遵循哪些基本原则？ (百度)
8. 索引在查询时候要遵循一个最左匹配，这个最左匹配是什么情况？ (百度)
9. 怎么设置主键 (虾皮)
10. 自增主键和随机主键的区别 (京东)
11. 索引失效
    1. 加了索引一定会走索引吗？索引失效的情况有哪些？(京东科技、字节飞书、京东*2)
    2. 如果我想要强制走某个索引，能实现吗？(京东科技)
    3. 联合索引 (a, b, c)，where 条件为 a = 1, c = 2，这个索引会生效吗？ (百度)
    4. 范围查询会用到索引吗 (京东)
    5. 覆盖索引是什么？ (京东)


## 三、数据库调优
1. SQL优化 (字节飞书)
2. Explain进行查询性能优化，需要关注哪些字段? (网易云音乐、字节飞书)
3. 怎么做数据库调优 (有赞)
4. 慢查询  (京东)
5. 分库分表 (携程)
6. 数据库读写分离 (蚂蚁)
7. 三大范式 (虾皮、有赞)
8. mysql 不用窗口函数 怎么实现分组排序(百度)

## 五、其他
1. 场景题：
   1. 一个时间段、年龄 > 50 怎么建立索引
   2. 五千万数据包含了姓名年龄出生日期如何保存到数据库中？ (携程)
2. 5种io， select epoll区别，select数组为什么默认1024 ？ (拼多多)
3. 日志
   1. 从mysql update语句出发， 要求说出binlog 与 redolog一致性问题 (美团)
   2. undo log、binlog、redo log (华为)
   3. 说说binlog和redolog，redolog两阶段提交的过程？ (字节飞书)
   4. 版本链存在哪里 (有赞)
   5. 版本链和回滚日志的关系 (有赞)
   6. 回滚日志和重做日志还有二进制日志的作用 (有赞)

# 中间件

## 一、Redis
1. 原理
   1. Redis用来干什么？
   2. 对Redis了解多吗？你觉得Redis最核心的功能是什么？ (蚂蚁金服)
   3. redis讲一下为什么单线程还那么快呢 (小米、OPPO)
      - 多路复用模型
2. 使用
   1. Redis的基本数据类型有哪些？ (工信部电子五所、美团优选、网易云音乐、腾讯音乐、京东)
      - 5个基础数据结构和3个高级数据结构
      1. zset用来做什么，底层数据结构，为什么不用set？ (腾讯音乐、京东)
      2. zset的性能和什么有关系，时间复杂度是多少，会随着我的数据越大耗时越多吗 (京东)
      3. Redis除了常用的数据结构外，还熟悉其他的数据结构吗？ (阿里Lazada)
      4. Redis存储地图的数据结构，即GEO（地理位置）数据类型，有什么特点呢？有没有用过 (阿里Lazada)
      5. HyperLoglog 可以优化 HashMap 用来统计访问量、点击量等数据 (京东)
   2. 过期时间expire怎么设置，设置多长？ (有赞)
   3. 数据淘汰策略，Iru如何实现 (美团优选、网易云音乐、字节飞书)
      - 定期删除、惰性删除、定时删除
   4. 项目 中用到了 redis 的什么结构，怎么用的 (拼多多)
   5. redis的跳表的实现 (拼多多、网易云音乐)
   6. 为什么epoll遍历就绪链表比select更快 (OPPO)
   7. 举一个Redis的使用场景 (网易云音乐)
   8. redis怎么实现持久化？持久化能保证不丢失数据吗？ (字节飞书、有赞)
   9. 怎么考虑设置热点数据的 (有赞)
   10. 对什么数据设置三级缓存 (有赞)


3. 问题
   1. 缓存穿透， 缓存击穿， 缓存雪崩基本概念及解决方案 (蚂蚁金服、美团、有赞、京东)
   2. 在项目中，如何保证缓存和数据库数据的一致性？ (美团优选、蚂蚁)
4. 集群
   1. redis哨兵集群相关问题（怎么主从同步，怎么哨兵选举，怎么master选举） (美团)
   2. Redis集群的部署方式 (网易云音乐)
5. 其他
   1. 布隆过滤器的原理是什么？它的优点是什么？缺陷是什么？ (蚂蚁金服)
   2. redis怎么实现分布式锁，手写伪代码，怎么获取锁和释放锁 (字节抖音、有赞、百度、快手)
      1. Redis怎么实现分布式锁，具体的命令是什么？如果是分布式集群会有什么问题？(字节飞书、京东)
         - RedLock算法 
      2. 果有 A、B 两个线程同时获取锁，都去 Redis 中加锁，假设 A 先加锁，但是 A 比较磨叽，没加完，这时候 B 也来加锁，B 不磨叽，立马加上了锁，A 就会产生一个独占了这把锁的假象，继续执行，怎么解决？ (百度)
   3. Redis支持事务吗？与mysql的事务有什么不同 (字节飞书)


## 二、MQ
1. mq的作用 (美团优选)
   - 异步、削峰、解耦
2. kafka
   1. kafka 介绍，作用，原理 (美团优选、网易云音乐、有赞、京东)
   2. kafka 可以保证数据消费的有序性吗，为什么 (京东)
   3. kafka 副本了解吗，讲一下 (美团优选)
   4. kafka 高可用架构了解吗，为什么kafka吞吐量很高 (OPPO)
   5. 一致性算法了解哪些，讲一下raft算法的写入读取，以及选举流程，写入的同时读到了未写入的节点会有什么问题，raft怎么解决的 (OPPO)
   6. Kafka 的消息丢失问题，考虑主从同步 (网易云音乐)
   7. kafka 的过程？(有赞)
3. 为什么不让一个partition被同组的多个consumer消费 (美团优选)
4. Rocket
   1. Rocket事务消息的实现机制 (网易云音乐)
   2. RocketMQ和Kafka的区别 (网易云音乐)
   3. 从银行转账出发， 要求描述出两阶段提交基于RocketMQ (美团)


# 三、ES
1. ES如何使用?为何ES查询会变快?目前用的哪款分词器?ES和数据库数据不一致该如何处理? (网易云音乐)
3. ES为什么快？(有赞)

# 四、其他
1. 中间件都用什么？ (百度)
2. 项目中 kafka 和 redis 怎么用的，为什么用它 (京东)
